<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="favicon.jpg">

  <title>Aleron | Performance Dashboard</title>

  <!-- Bootstrap core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/dashboard.css" rel="stylesheet">

  <link rel="stylesheet" href="css/normalize.css">
  <style>
    #chart {
      height: 360px;
      margin: 0 auto;                                               /* NEW */
      position: relative;
      width: 360px;
    }
    .tooltip {
      background: #eee;
      box-shadow: 0 0 5px #999999;
      color: #333;
      display: none;
      font-size: 12px;
      left: 130px;
      padding: 10px;
      position: absolute;
      text-align: center;
      top: 95px;
      width: 80px;
      z-index: 10;
    }
    .legend {
      font-size: 12px;
    }
    rect {
      cursor: pointer;                                              /* NEW */
      stroke-width: 2;
    }
    rect.disabled {                                                 /* NEW */
      fill: transparent !important;                                 /* NEW */
    }                                                               /* NEW */
    h1 {                                                            /* NEW */
      font-size: 14px;                                              /* NEW */
      text-align: center;                                           /* NEW */
    } 


    .axis path,
    .axis line {
      fill: none;
      stroke: black;
      shape-rendering: crispEdges;
    }

    .axis text {
        font-family: sans-serif;
        font-size: 11px;
    }                                                              /* NEW */
  </style>

  <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
  <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
  <!-- <script src="js/ie-emulation-modes-warning.js"></script> -->

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
    </head>

    <body>

     <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Aleron Dashboard</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form>
        </div>
      </div>
    </nav>


    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="#">Overview <span class="sr-only">(current)</span></a></li>
            <li><a href="#">Reports</a></li>
            <li><a href="#">Analytics</a></li>
            <li><a href="#">Export</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Help(Guidance)</a></li>
            <li><a href="">Executive Summary</a></li>
            <li><a href="">Risk Register</a></li>
            <li><a href="">Risk Mitigations</a></li>
            <li><a href="">People</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Impact</a></li>
            <li><a href="">People</a></li>
            <li><a href="">Finance</a></li>
            <li><a href="">Busines</a></li>
            <li><a href="">SBP</a></li>
          </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h1 class="page-header">Aleron Performance Dashboard</h1>

          <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/200x200?bg=#DC143C" class="img-responsive" alt="generic placeholder thumbnail">
              <h4>People</h4>
              <span class="text-muted">People make the difference</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/200x200/auto/vine" class="img-responsive" alt="generic placeholder thumbnail">
              <h4>Finance</h4>
              <span class="text-muted">Plan carefully</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/200x200?bg=#FF7F50" class="img-responsive" alt="generic placeholder thumbnail">
              <h4>Impact</h4>
              <span class="text-muted">Impact matters</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/200x200/auto/vine" class="img-responsive" alt="generic placeholder thumbnail">
              <h4>Risk</h4>
              <span class="text-muted">something else</span>
            </div>
          </div>

          <h2 class="sub-header">Dummy Data</h2>
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>#</th>
                  <th>First</th>
                  <th>Second</th>
                  <th>Third</th>
                  <th>Fourth</th>
                  <th>Annual</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1,001</td>
                  <td>lorem</td>
                  <td>ipsum</td>
                  <td>dolor</td>
                  <td>sit</td>
                  <td>stand</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>sagittis</td>
                  <td>ipsum</td>
                  <td>praesent</td>
                  <td>mauris</td>
                  <td>stand</td>
                </tr>
                <tr>
                  <td>1,003</td>
                  <td>sodales</td>
                  <td>ligula</td>
                  <td>in</td>
                  <td>libero</td>
                  <td>stand</td>
                </tr>
              </tbody>
            </table>
          </div>         
          <h2 class="sub-header">KPI RAG Parameters</h2>
          <div class="containter-fluid">            
            <div>
            <script type="text/javascript" src="js/bootstrap-filestyle.min.js"> </script>
            <script type="text/javascript">
                $(":file").filestyle();
            </script>         
            </div>          
          </div>
      </div>
    </div>
  </div>

        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h2 class="sub-header">KPI Visualisation</h2>
          <div class="row placeholders">
            <div id ="barChart" class="col-md-6 col-xs-3 placeholder">
            <!--<img data-src="holder.js/200x200?bg=#DC143C" class="img-responsive" alt="generic placeholder thumbnail"> -->
              <h4 id="kpiName"></h4>
              <span class="text-muted">Performance of the KPI over the four quarters</span>
              <p> <br> <br> </p>
             <script src="js/d3.min.js" type="text/javascript"></script>
             <script type="text/javascript">               
                //Width and height
                var w = 200;
                var h = 200;
                var padding = 0;
                
                var kpi = 
                        {
                         name : "Growth in statutory income (£m, Cumulative)",
                         frequency : 4,
                         unit : "k",
                         type : "cumulative",
                         quarterName : ["Q1", "Q2", "Q2", "Q4"],
                         targetValue : [43.7, 87.1, 131.4, 171.6],
                         actualValue : [43.2, 82.8, 125.8, 176.3],
                         foreCastValue : [30, 60, 100, 120],
                         yearlyTarget : 120,
                         yearlyForeCast : 120,
                         ragThreshold : [[0.94, 0.98], [.94, .98]],
                         comments : "We achieved a 3.6% growth in statutory income. We want to grow annual income by £13m or 4% as per the budget. Q1 target growth is £3.25m"                       
                       };
            
                  if ( kpi.actualValue.length != kpi.targetValue.length )
                  {
                    console.log( "Target values not of the same length as actual values.")
                  }
                  
                  var dataSet = [ kpi.actualValue, kpi.targetValue ];

                  var i;
                  var dataSet = [];
                  dataSet = kpi;
                  
                  var dataMax = d3.max(dataSet.actualValue);
                  var tempMax = d3.max(dataSet.targetValue);
                  
                  var dataMin = d3.min(dataSet.actualValue);                  
                  var tempMin = d3.min(dataSet.targetValue);
                  
                  dataMax = d3.max([tempMax, dataMax]);
                  dataMin = d3.min([tempMin, dataMin]);

                  if ( dataMin > 0 )
                  {
                    dataMin = 0;
                  }

                  var dataset = d3.range(dataSet.frequency);
                  var xScale = d3.scale.ordinal()
                          .domain(d3.range(kpi.frequency))
                          .rangeRoundBands([0, w], 0.2);

                  var yScale = d3.scale.linear()
                          .domain([dataMin, dataMax])
                          .range([0, h]);
                  
                    //Create SVG element
                    var svg = d3.select("#barChart")
                          .append("svg")
                          .attr("width", w)
                          .attr("height", h)                                             

                    //Create bars
                    svg.selectAll("rect")
                       .data(dataset)
                       .enter()
                       .append("rect")
                       .attr("x", function(d, i) {
                          return xScale(i);
                       })
                       .attr("y", function(d) {
                          return h - yScale(d);
                       })
                       .attr("width", xScale.rangeBand())
                       .attr("height", function(d) {
                          return yScale(d);
                       })
                       .attr("fill", function(d) {
                        return "rgb(0, 0, " + (d * 10) + ")";
                       });

                    //Create labels
                    svg.selectAll("text")
                       .data(dataset)
                       .enter()
                       .append("text")
                       .text(function(d) {
                          return d;
                       })
                       .attr("text-anchor", "middle")
                       .attr("x", function(d, i) {
                          return xScale(i) + xScale.rangeBand() / 2;
                       })
                       .attr("y", function(d) {
                          return h - yScale(d) + 14;
                       })
                       .attr("font-family", "sans-serif")
                       .attr("font-size", "11px")
                       .attr("fill", "white");

                  var xAxis = d3.svg.axis()
                  .scale(xScale)
                  .orient("bottom");

                  svg.append("g")
                  .attr("class", "axis") //Assign "axis" class
                  .attr("transform", "translate(0," + (h - padding) + ")")
                  .call(xAxis);

            

                  

                    //On click, update with new data      
                    d3.select("svg")
                      .on("click", function() {

                        //New values for dataset
                        var numValues = dataset.length;               //Count original length of dataset
                        var maxValue = 100;                     //Highest possible new value
                        dataset = [];                         //Initialize empty array
                        for (var i = 0; i < numValues; i++) {           //Loop numValues times
                          var newNumber = Math.floor(Math.random() * maxValue); //New random integer (0-100)
                          dataset.push(newNumber);                //Add new number to array
                        }
                        
                        //Update scale domain
                        //Recalibrate the scale domain, given the new max value in dataset
                        yScale.domain([0, d3.max(dataset)]);

                        //Update all rects
                        svg.selectAll("rect")
                           .data(dataset)
                           .transition()
                           .delay(function(d, i) {
                             return i / dataset.length * 1000;
                           })
                           .duration(500)
                           .attr("y", function(d) {
                              return h - yScale(d);
                           })
                           .attr("height", function(d) {
                              return yScale(d);
                           })
                           .attr("fill", function(d) {
                            //return "pink";
                            //return "rgb(255, 0, 157)";//dark pink
                            //return "orange";
                            //return "green";
                            return "rgb(0, 0, " + (d * 10) + ")";
                           })

                        //Update all labels
                        svg.selectAll("text")
                           .data(dataset)
                           .transition()
                           .delay(function(d, i) {
                             return i / dataset.length * 1000;
                           })
                           .duration(500)
                           .text(function(d) {
                              return d;
                           })
                           .attr("x", function(d, i) {
                              return xScale(i) + xScale.rangeBand() / 2;
                           })
                           .attr("y", function(d) {
                              return h - yScale(d) + 14;
                           });                             
                      });

              </script>
              
            </div>
            <div id = "commentBox" class="col-md-6 col-xs-3 placeholder">
              <h4>Comments</h4>
              <span class="text-muted">KPI Explanation</span>
              <script type="text/javascript">
                d3.select("#commentBox").append("p").text(kpi.comments)
                d3.select("#kpiName").text(kpi.name)
              </script>
            </div>            
          </div>

    <!-- bootstrap core javascript
    ================================================== -->
    <!-- placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/d3.min.js"></script>
    <!-- just to make our placeholder images work. don't actually copy the next line! -->
    <!--<script src="js/vendor/holder.min.js"></script> -->
    <script src="js/holder.min.js"></script>
    <!-- ie10 viewport hack for surface/desktop windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
  </body>
  </html>
